A number of system services, mainly for input and output, are available for use by your MIPS program. They are described in the table below.

MIPS register contents are not affected by a system call, except for result registers as specified in the table below.

### How to use SYSCALL system services

Step 1. Load the service number in register `$v0`.  
Step 2. Load argument values, if any, in `$a0`, `$a1`, `$a2`, or `$f12` as specified.  
Step 3. Issue the SYSCALL instruction.  
Step 4. Retrieve return values, if any, from result registers as specified.  
**Example: display the value stored in $t0 on the console**  


```mips
li  $v0, 1           # service 1 is print integer
add $a0, $t0, $zero  # load desired value into argument register $a0, using pseudo-op
syscall
```


### Available Services

| `$v0` | Service                      | Arguments                                                                                                                                                                                                                                                                                                                                                                               | Result                                                                                                                                                                                                                                                                                                                                                                                                     |
| ----- | ---------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1     | print integer                | `$a0` = integer to print                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                            |
| 2     | print float                  | `$f12` = float to print                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                            |
| 3     | print double                 | `$f12` = double to print                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                            |
| 4     | print string                 | `$a0` = address of null-terminated string to print                                                                                                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                            |
| 5     | read integer                 |                                                                                                                                                                                                                                                                                                                                                                                         | `$v0` contains integer read                                                                                                                                                                                                                                                                                                                                                                                |
| 6     | read float                   |                                                                                                                                                                                                                                                                                                                                                                                         | `$f0` contains float read                                                                                                                                                                                                                                                                                                                                                                                  |
| 7     | read double                  |                                                                                                                                                                                                                                                                                                                                                                                         | `$f0` contains double read                                                                                                                                                                                                                                                                                                                                                                                 |
| 8     | read string                  | `$a0` = address of input buffer  <br>`$a1` = maximum number of characters to read                                                                                                                                                                                                                                                                                                       | _See note below table_                                                                                                                                                                                                                                                                                                                                                                                     |
| 9     | sbrk (allocate heap mem.)    | `$a0` = number of bytes to allocate                                                                                                                                                                                                                                                                                                                                                     | `$v0` contains address of allocated memory                                                                                                                                                                                                                                                                                                                                                                 |
| 10    | exit (terminate exe.)        |                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                            |
| 11    | print character              | `$a0` = character to print                                                                                                                                                                                                                                                                                                                                                              | _See note below table_                                                                                                                                                                                                                                                                                                                                                                                     |
| 12    | read character               |                                                                                                                                                                                                                                                                                                                                                                                         | `$v0` contains character read                                                                                                                                                                                                                                                                                                                                                                              |
| 13    | open file                    | `$a0` = address of null-terminated string containing filename  <br>`$a1` = flags  <br>`$a2` = mode                                                                                                                                                                                                                                                                                      | `$v0` contains file descriptor (negative if error). _See note below table_                                                                                                                                                                                                                                                                                                                                 |
| 14    | read from file               | `$a0` = file descriptor  <br>`$a1` = address of input buffer  <br>`$a2` = maximum number of characters to read                                                                                                                                                                                                                                                                          | `$v0` contains number of characters read (0 if end-of-file, negative if error). _See note below table_                                                                                                                                                                                                                                                                                                     |
| 15    | write to file                | `$a0` = file descriptor  <br>`$a1` = address of output buffer  <br>`$a2` = number of characters to write                                                                                                                                                                                                                                                                                | `$v0` contains number of characters written (negative if error). _See note below table_                                                                                                                                                                                                                                                                                                                    |
| 16    | close file                   | `$a0` = file descriptor                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                            |
| 17    | exit2 (terminate with value) | `$a0` = termination result                                                                                                                                                                                                                                                                                                                                                              | _See note below table_                                                                                                                                                                                                                                                                                                                                                                                     |
|       |                              |                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                            |
| 30    | time (system time)           |                                                                                                                                                                                                                                                                                                                                                                                         | `$a0` = low order 32 bits of system time  <br>`$a1` = high order 32 bits of system time. _See note below table_                                                                                                                                                                                                                                                                                            |
| 31    | MIDI out                     | `$a0` = pitch (0-127)  <br>`$a1` = duration in milliseconds  <br>`$a2` = instrument (0-127)  <br>`$a3` = volume (0-127)                                                                                                                                                                                                                                                                 | Generate tone and return immediately. _See note below table_                                                                                                                                                                                                                                                                                                                                               |
| 32    | sleep                        | `$a0` = the length of time to sleep in milliseconds.                                                                                                                                                                                                                                                                                                                                    | Causes the MARS Java thread to sleep for (at least) the specified number of milliseconds. This timing will not be precise, as the Java implementation will add some overhead.                                                                                                                                                                                                                              |
| 33    | MIDI out sync.               | `$a0` = pitch (0-127)  <br>`$a1` = duration in milliseconds  <br>`$a2` = instrument (0-127)  <br>`$a3` = volume (0-127)                                                                                                                                                                                                                                                                 | Generate tone and return upon tone completion. _See note below table_                                                                                                                                                                                                                                                                                                                                      |
| 34    | print integer in hexadecimal | `$a0` = integer to print                                                                                                                                                                                                                                                                                                                                                                | Displayed value is 8 hexadecimal digits, left-padding with zeroes if necessary.                                                                                                                                                                                                                                                                                                                            |
| 35    | print int. in binary         | `$a0` = integer to print                                                                                                                                                                                                                                                                                                                                                                | Displayed value is 32 bits, left-padding with zeroes if necessary.                                                                                                                                                                                                                                                                                                                                         |
| 36    | print int. as unsigned       | `$a0` = integer to print                                                                                                                                                                                                                                                                                                                                                                | Displayed as unsigned decimal value.                                                                                                                                                                                                                                                                                                                                                                       |
| 37-39 | (not used)                   |                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                            |
| 40    | set seed                     | `$a0` = i.d. of pseudorandom number generator (any int).  <br>`$a1` = seed for corresponding pseudorandom number generator.                                                                                                                                                                                                                                                             | No values are returned. Sets the seed of the corresponding underlying Java pseudorandom number generator (java.util.Random). _See note below table_                                                                                                                                                                                                                                                        |
| 41    | random int                   | `$a0` = i.d. of pseudorandom number generator (any int).                                                                                                                                                                                                                                                                                                                                | `$a0` contains the next pseudorandom, uniformly distributed int value from this random number generator's sequence. _See note below table_                                                                                                                                                                                                                                                                 |
| 42    | random int range             | `$a0` = i.d. of pseudorandom number generator (any int).  <br>`$a1` = upper bound of range of returned values.                                                                                                                                                                                                                                                                          | `$a0` contains pseudorandom, uniformly distributed int value in the range 0 = [int] [upper bound], drawn from this random number generator's sequence. _See note below table_                                                                                                                                                                                                                              |
| 43    | random float                 | `$a0` = i.d. of pseudorandom number generator (any int).                                                                                                                                                                                                                                                                                                                                | `$f0` contains the next pseudorandom, uniformly distributed float value in the range 0.0 = f 1.0 from this random number generator's sequence. _See note below table_                                                                                                                                                                                                                                      |
| 44    | random double                | `$a0` = i.d. of pseudorandom number generator (any int).                                                                                                                                                                                                                                                                                                                                | `$f0` contains the next pseudorandom, uniformly distributed double value in the range 0.0 = f 1.0 from this random number generator's sequence. _See note below table_                                                                                                                                                                                                                                     |
| 45-49 | (not used)                   |                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                            |
| 50    | ConfirmDialog                | `$a0` = address of null-terminated string that is the message to user                                                                                                                                                                                                                                                                                                                   | `$a0` contains value of user-chosen option  <br>0: Yes  <br>1: No  <br>2: Cancel                                                                                                                                                                                                                                                                                                                           |
| 51    | InputDialogInt               | `$a0` = address of null-terminated string that is the message to user                                                                                                                                                                                                                                                                                                                   | `$a0` contains int read  <br>`$a1` contains status value  <br>0: OK status  <br>-1: input data cannot be correctly parsed  <br>-2: Cancel was chosen  <br>-3: OK was chosen but no data had been input into field                                                                                                                                                                                          |
| 52    | InputDialogFloat             | `$a0` = address of null-terminated string that is the message to user                                                                                                                                                                                                                                                                                                                   | `$f0` contains float read  <br>`$a1` contains status value  <br>0: OK status  <br>-1: input data cannot be correctly parsed  <br>-2: Cancel was chosen  <br>-3: OK was chosen but no data had been input into field                                                                                                                                                                                        |
| 53    | InputDialogDouble            | `$a0` = address of null-terminated string that is the message to user                                                                                                                                                                                                                                                                                                                   | `$f0` contains double read  <br>`$a1` contains status value  <br>0: OK status  <br>-1: input data cannot be correctly parsed  <br>-2: Cancel was chosen  <br>-3: OK was chosen but no data had been input into field                                                                                                                                                                                       |
| 54    | InputDialogString            | `$a0` = address of null-terminated string that is the message to user  <br>`$a1` = address of input buffer  <br>`$a2` = maximum number of characters to read                                                                                                                                                                                                                            | _See Service 8 note below table_  <br>`$a1` contains status value  <br>0: OK status. Buffer contains the input string.  <br>-2: Cancel was chosen. No change to buffer.  <br>-3: OK was chosen but no data had been input into field. No change to buffer.  <br>-4: length of the input string exceeded the specified maximum. Buffer contains the maximum allowable input string plus a terminating null. |
| 55    | MessageDialog                | `$a0` = address of null-terminated string that is the message to user  <br>`$a1` = the type of message to be displayed:  <br>0: error message, indicated by Error icon  <br>1: information message, indicated by Information icon  <br>2: warning message, indicated by Warning icon  <br>3: question message, indicated by Question icon  <br>other: plain message (no icon displayed) | N/A                                                                                                                                                                                                                                                                                                                                                                                                        |
| 56    | MessageDialogInt             | `$a0` = address of null-terminated string that is an information-type message to user  <br>`$a1` = int value to display in string form after the first string                                                                                                                                                                                                                           | N/A                                                                                                                                                                                                                                                                                                                                                                                                        |
| 57    | MessageDialogFloat           | `$a0` = address of null-terminated string that is an information-type message to user  <br>`$f12` = float value to display in string form after the first string                                                                                                                                                                                                                        | N/A                                                                                                                                                                                                                                                                                                                                                                                                        |
| 58    | MessageDialogDouble          | `$a0` = address of null-terminated string that is an information-type message to user  <br>`$f12` = double value to display in string form after the first string                                                                                                                                                                                                                       | N/A                                                                                                                                                                                                                                                                                                                                                                                                        |
| 59    | MessageDialogString          | `$a0` = address of null-terminated string that is an information-type message to user  <br>`$a1` = address of null-terminated string to display after the first string                                                                                                                                                                                                                  | N/A                                                                                                                                                                                                                                                                                                                                                                                                        |
| 58    | MessageDialogDouble          | `$a0` = address of null-terminated string that is an information-type message to user  <br>`$f12` = double value to display in string form after the first string                                                                                                                                                                                                                       | N/A                                                                                                                                                                                                                                                                                                                                                                                                        |
| 59    | MessageDialogString          | `$a0` = address of null-terminated string that is an information-type message to user  <br>`$a1` = address of null-terminated string to display after the first string                                                                                                                                                                                                                  | N/A                                                                                                                                                                                                                                                                                                                                                                                                        |



> _Services 1 through 17 are compatible with the SPIM simulator, other than Open File (13) as described in the Notes below the table. Services 30 and higher are exclusive to MARS._
  
**NOTES: Services numbered 30 and higher are not provided by SPIM**  
**Service 8** - Follows semantics of UNIX 'fgets'. For specified length n, string can be no longer than n-1. If less than that, adds newline to end. In either case, then pads with null byte If n = 1, input is ignored and null byte placed at buffer address. If n 1, input is ignored and nothing is written to the buffer.  
**Service 11** - Prints ASCII character corresponding to contents of low-order byte.  
**Service 13** - MARS implements three flag values: 0 for read-only, 1 for write-only with create, and 9 for write-only with create and append. It ignores mode. The returned file descriptor will be negative if the operation failed. The underlying file I/O implementation uses java.io.FileInputStream.read() to read and java.io.FileOutputStream.write() to write. MARS maintains file descriptors internally and allocates them starting with 3. File descriptors 0, 1 and 2 are always open for: reading from standard input, writing to standard output, and writing to standard error, respectively (new in release 4.3).  
**Services 13,14,15** - In MARS 3.7, the result register was changed to `$v0` for SPIM compatability. It was previously `$a0` as erroneously printed in Appendix B of _Computer Organization and Design,_.  
**Service 17** - If the MIPS program is run under control of the MARS graphical interface (GUI), the exit code in `$a0` is ignored.  
**Service 30** - System time comes from java.util.Date.getTime() as milliseconds since 1 January 1970.  
**Services 31,33** - Simulate MIDI output through sound card. Details below.  
**Services 40-44** use underlying Java pseudorandom number generators provided by the java.util.Random class. Each stream (identified by `$a0` contents) is modeled by a different Random object. There are no default seed values, so use the Set Seed service (40) if replicated random sequences are desired.

# Example of File I/O

The sample MIPS program below will open a new file for writing, write text to it from a memory buffer, then close it. The file will be created in the directory in which MARS was run.


```mips
# Sample MIPS program that writes to a new file.
# by Kenneth Vollmar and Pete Sanderson

.data
fout:   .asciiz "testout.txt"      # filename for output
buffer: .asciiz "The quick brown fox jumps over the lazy dog."
.text
###############################################################
# Open (for writing) a file that does not exist
li   $v0, 13       # system call for open file
la   $a0, fout     # output file name
li   $a1, 1        # Open for writing (flags are 0: read, 1: write)
li   $a2, 0        # mode is ignored
syscall            # open a file (file descriptor returned in $v0)
move $s6, $v0      # save the file descriptor 
###############################################################
# Write to file just opened
li   $v0, 15       # system call for write to file
move $a0, $s6      # file descriptor 
la   $a1, buffer   # address of buffer from which to write
li   $a2, 44       # hardcoded buffer length
syscall            # write to file
###############################################################
# Close the file 
li   $v0, 16       # system call for close file
move $a0, $s6      # file descriptor to close
syscall            # close file
###############################################################
```




